### 1\. 策略概述

`vdub_Trend_Master_v6 Strategy` 是一個基於 Pine Script v6 開發的 TradingView 交易策略，旨在提供多維度的市場分析和自動化的交易信號。此策略結合了多種流行且有效的技術指標，包括類一目均衡表、多時間框架高低點、多重移動平均線、RSI 等，以識別趨勢、動能、支撐與阻力，並生成潛在的買入/賣出信號。

**核心目標：**

  * 整合多種指標，提供全面的市場視角。
  * 透過 N 取 K 邏輯，增加交易信號的可靠性。
  * 輔助交易者進行趨勢判斷和交易決策。

-----

### 2\. 功能模組與判讀方法

#### 2.1. 趨勢與動能指標

##### 2.1.1. 📊 Ichimoku-like Donchian Channel Components (一目均衡表類唐奇安通道組件)

  * **作用：** 提供類似一目均衡表的趨勢、支撐阻力識別及前瞻性預測。
  * **組成部分：**
      * `conversionLine` (轉換線): 短期價格中點線。
      * `baseLine` (基準線): 中期價格中點線。
      * `leadLine1` (先行線1, 藍色): 轉換線與基準線的平均，向前平移 `displacement` 週期。
      * `leadLine2` (先行線2, 橙色): 過去 `laggingSpan2Periods` 週期的價格中點，向前平移 `displacement` 週期。
      * **雲層 (Kumo)**: 由 `leadLine1` 和 `leadLine2` 之間的填充區域形成。
  * **如何判讀：**
      * **轉換線與基準線交叉：**
          * 藍色轉換線上穿橙色基準線：短期趨勢轉強，潛在買入信號。
          * 藍色轉換線下穿橙色基準線：短期趨勢轉弱，潛在賣出信號。
      * **雲層 (Kumo)：**
          * 價格位於雲層上方：強勁上漲趨勢，雲層作為支撐。
          * 價格位於雲層下方：強勁下跌趨勢，雲層作為阻力。
          * 價格進入雲層：市場可能處於盤整或趨勢不明朗階段。
          * 雲層厚度：雲層越厚，支撐或阻力越強；越薄則越容易被突破。
      * **先行線 (`leadLine1`, `leadLine2`)：** 由於向前平移，它們提供了**未來**可能出現的支撐或阻力區域，具有前瞻性。觀察其交叉點和雲層厚度變化，可預判未來趨勢變化。

##### 2.1.2. 📈 Madrid - Multiple Moving Averages (多重移動平均線)

  * **作用：** 繪製多組指數移動平均線 (EMA) 或簡單移動平均線 (SMA)，用於判斷趨勢和市場動能。
  * **顯眼繪製線條：**
      * **MA 5 (藍色, `linewidth=2`)：** 超短期趨勢。
      * **MA 30 (紫紅色, `linewidth=2`)：** 短期趨勢。
      * **MA 90 (橙色, `linewidth=2`)：** 中期趨勢。
  * **如何判讀：**
      * **MA 排列與斜率：**
          * 短期 MA 在長期 MA 上方且所有 MA 向上發散：強勁上升趨勢。
          * 短期 MA 在長期 MA 下方且所有 MA 向下發散：強勁下降趨勢。
          * MA 相互糾纏或走平：市場可能處於盤整。
      * **MA 線顏色（動能判斷）：**
          * **灰色：** MA 上漲且位於長期參考 MA（ma100）之上，表示強勁上升趨勢。
          * **紅色：** MA 下跌，或 MA 上漲但位於長期參考 MA 之下，表示趨勢疲軟或下降。
          * **銀色：** MA 上漲但仍位於長期參考 MA 之下，可能表示下跌趨勢中的反彈。

##### 2.1.3. 💲 Madrid Profit Area (利潤區間)

  * **作用：** 透過快速 MA (`fastMA`, 5週期) 和慢速 MA (`slowMA`, 90週期) 之間的填充區域，視覺化市場的趨勢強度或「盈利區間」。
  * **如何判讀：**
      * **填充區域 (color.new(color.silver, 75))：** 當快速 MA 和慢速 MA 之間形成填充區域時，表示市場處於趨勢之中。
      * **MA 線顏色：** `fastMA` 和 `slowMA` 的顏色也會動態變化，上漲時為銀色，下跌時為紅色。
      * **快慢 MA 交叉點：**
          * 快 MA 上穿慢 MA：潛在買入機會，趨勢向上。
          * 快 MA 下穿慢 MA：潛在賣出機會，趨勢向下。

#### 2.2. 支撐與阻力指標

##### 2.2.1. 🕰️ RicardoSantos - Extreme Time Frame High/Low (極端時間框架高低點)

  * **作用：** 獲取並繪製指定「極端時間框架」（預設為 240 分鐘，即 4 小時線）內的最高價 (`TEH`, 紅色) 和最低價 (`TEL`, 綠色) 為水平線。
  * **如何判讀：**
      * 這些水平線被視為重要的長期**支撐和阻力位**。
      * 觀察價格在這些線附近的行為：當價格接近或突破這些高低點時，可能預示著趨勢的延續或反轉。

##### 2.2.2. 📅 Lachlan Smith - Daily/Weekly/Monthly High & Lows (日/週/月高低點)

  * **作用：** 在當前圖表上，繪製前一個交易日 (`dHigh`/`dLow`, 紫色), 交易週 (`wHigh`/`wLow`, 青色) 或交易月 (`mHigh`/`mLow`, 銀色) 的最高價和最低價。可透過輸入參數控制是否顯示。
  * **如何判讀：**
      * 這些水平線是重要的短期至中長期**支撐/阻力位**，代表了歷史上價格的關鍵轉折區域。
      * **日內交易：** 關注日線高低點。
      * **波段交易：** 關注週線高低點。
      * **長期趨勢：** 關注月線高低點。
      * 觀察價格在這些線附近的反應（反彈、突破、假突破），以判斷趨勢的延續或反轉。

##### 2.2.3. 🎯 Jurij - Price Time Zone (PTZ) / Channel (價格時區/通道)

  * **作用：** 識別圖表上的關鍵樞軸點（特定時間窗口內的最高/最低價）和動態通道。
  * **如何判讀：**
      * **綠色 "▲" (Buy PTZ)：** 表示在定義的時間窗口內（`h_left` + `h_right` + 中心 K 線），該中心 K 線的最低價是整個區域的最低點。標誌著一個潛在的**底部反轉買入信號**。
      * **紅色 "▼" (Sell PTZ)：** 表示在相同時間窗口內，該中心 K 線的最高價是整個區域的最高點。標誌著一個潛在的**頂部反轉賣出信號**。
      * **銀色通道 (PTZ Channel High / PTZ Channel Low)：** 代表了基於近期歷史最高/最低價的動態價格區間。價格在此通道內波動，突破通道邊界可能預示著趨勢的啟動或加速。通道提供了潛在的支撐和阻力區域。

#### 2.3. 震盪與超買超賣指標

##### 2.3.1. 📊 Relative Strength Index (RSI)

  * **作用：** 測量價格變動的速度和變化，以判斷市場是否處於超買或超賣狀態。
  * **繪製線條：**
      * **RSI 14 (白色, `linewidth=2`)**
      * **RSI 7 (黃色, `linewidth=2`)**
  * **設定：**
      * 超買區 (`rsiOverbought`, 預設 70, 紅色水平線)。
      * 超賣區 (`rsiOversold`, 預設 30, 綠色水平線)。
  * **如何判讀：**
      * **超買區 (通常 \> 70)：** 表示買方力量過度，可能預示價格即將回調或下跌。
      * **超賣區 (通常 \< 30)：** 表示賣方力量過度，可能預示價格即將反彈或上漲。
      * **趨勢確認：** RSI 與價格的背離（價格創新高/低，RSI 未創新高/低）可能預示趨勢反轉。
      * **RSI 7 (黃色)：** 作為更靈敏的短期動能指標，可配合 RSI 14 進行判斷。

-----

### 3\. 策略進出場邏輯 (N取K邏輯)

此策略的進出場信號是基於多個指標的組合判斷，採用「N 取 K」的邏輯，即在 N 個條件中，至少滿足 K 個條件才會觸發交易。這有助於提高信號的可靠性，減少錯誤交易。

#### 3.1. ✅ 買入條件 (5取3)

當以下 5 個條件中，**至少滿足 3 個**時，策略會觸發買入 (`strategy.entry("Buy", strategy.long)`)：

1.  **短期 MA 動量上漲：** `ma05` (5 週期 MA) 上穿 `ma10` (10 週期 MA)。
      * *判讀：* 確認短期趨勢向上動能。
2.  **多重 MA 確認上升趨勢：** `ma05`、`ma10`、`ma15`、`ma20` 都高於長期 `ma100`。
      * *判讀：* 確認主要趨勢為上升趨勢。
3.  **MA 05 動能強勁：** `ma05` 的動能顏色為灰色（表示 `ma05` 正在上漲且高於 `ma100`）。
      * *判讀：* 強勢動能的視覺化確認。
4.  **價格從日線低點反彈：** 當前收盤價 `close` 高於前一日最低價 `dLow`，且前一根 K 線的收盤價 `close[1]` 低於或等於 `dLow[1]`。
      * *判讀：* 價格在關鍵支撐位得到支撐並反彈。
5.  **PTZ 買入信號：** 出現綠色 "▲" 符號 (`central_bar_is_lowest`)。
      * *判讀：* 確認底部樞軸點，潛在的反轉信號。

#### 3.2. ❌ 賣出條件 (3取2)

當以下 3 個條件中，**至少滿足 2 個**時，策略會觸發賣出 (`strategy.entry("Sell", strategy.short)`)：

1.  **價格位於 Ichimoku 雲層下方：** 當前收盤價 `close` 低於 `leadLine1` 和 `leadLine2`。
      * *判讀：* 確認主要趨勢為下降趨勢，雲層形成阻力。
2.  **短期 MA 低於長期 MA：** `ma05` (5 週期 MA) 低於 `ma100` (100 週期 MA)。
      * *判讀：* 再次確認下降趨勢。
3.  **RSI 超買後向下穿出：** `rsiValue` (RSI 14) 從超買區 (預設 \> 70) 向下穿出。
      * *判讀：* 震盪指標確認頂部反轉，多頭力量衰竭。

-----

### 4\. 重要注意事項

  * **風險管理：** 本策略僅提供進出場信號，**在啟用實盤交易前，強烈建議您在策略設定中添加止損 (Stop Loss) 和止盈 (Take Profit) 機制**。
      * **範例：**
        ```pinescript
        // 買入止損止盈範例
        strategy.exit("Exit Buy", from_entry="Buy", stop=close * 0.98, limit=close * 1.02) // 2% 止損, 2% 止盈
        // 賣出止損止盈範例
        strategy.exit("Exit Sell", from_entry="Sell", stop=close * 1.02, limit=close * 0.98) // 2% 止損, 2% 止盈
        ```
  * **歷史回測：** 在任何實盤應用之前，請務必進行**充分的歷史回測**，評估策略在不同市場條件下的表現。
  * **市場適應性：** 任何策略在不同市場（如股票、期貨、加密貨幣等）或不同時間框架下都可能表現出差異。請根據您的交易標的和風格進行調整和優化。
  * **非財務建議：** 本程式碼和 README 僅供學習和參考，不構成任何形式的投資建議。交易涉及風險，請謹慎投資。
